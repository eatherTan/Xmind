# Redis 如何测试

#### 1.缓存读写角度、2.缓存数据库双写一致性的角度、 3.数据过期时间角度、4.缓存雪崩、5.缓存击穿

1. Redis写入正常，如果是双写的话，写入到数据库正常；
2. 查询数据时：如果缓存中有数据，就直接拿缓存的数据；如果缓存没有数据，就从数据库查询，并且把数据写入到缓存中

3. 双写时，测试缓存与数据库双写一致：比如写入缓存失败，那么整个操作应该保持原子性，数据库也不写入
4. 测试数据的过期时间有没有在过期时间后面加一个随机值，这样可以大幅度减少缓存在同一时间过期

5. 缓存挂掉了的话或者说是数据的过期时间都是同样的没有分布均匀，导致缓存，缓存雪崩问题；看服务器如何处理

6. 测试缓存穿透的场景：代码有没有做对应的应对措施



### 概念解释：

**缓存穿透**

> Redis挂掉了，请求全部走数据库。
>
> 对缓存数据设置相同的过期时间，导致某段时间内缓存失效，请求全部走数据库。
>
> 缓存雪崩如果发生了，很可能就把我们的数据库搞垮，导致整个服务瘫痪!

缓存击穿：

> 缓存穿透是指查询一个一定不存在的数据。由于缓存不命中，并且出于容错考虑，于是就是查询数据库；如果从数据库查不到数据则不写入缓存，这将导致这个不存在的数据每次请求都要到数据库去查询，失去了缓存的意义。
>
> 比如：
>
> 我们有一张数据库表，ID都是从1开始的(正数)：
>
> 但是可能有黑客想把我的数据库搞垮，每次请求的ID都是负数。这会导致我的缓存就没用了，请求全部都找数据库去了，但数据库也没有这个值啊，所以每次都返回空出去。

