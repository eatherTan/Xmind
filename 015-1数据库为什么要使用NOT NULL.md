数据库库表设计时有很多字段都会设置成NOT NULL，我自己没有过多思考为什么设计成NOT NULL，我以为都是业务原因，没有从数据库设计的角度来看。

总结 - 艾小仙的 《为什么数据库字段要使用NOT NULL？》

目前大部分的开发都会把字段设置成`NOT NULL`并且给默认值的形式。

### 数据库一般设置列为NOT NULL 

通常默认值一般这样设置：

1. 整形，我们一般使用0作为默认值。
2. 字符串，默认使用空字符串
3. 时间，一般默认`1970-01-01 08:00:00`

但是，考虑下原因，为什么要设置成NOT NULL？

来自高性能`Mysql`中有这样一段话：

> 尽量避免NULL
>
> 很多表都包含可为NULL(空值)的列，即使应用程序并不需要保存NULL也是如此，这是因为可为NULL的列的默认属性。通常情况下最好指定列为NOT NULL,除非真的需要存储NULL 值。
>
> 如果查询中包含可为NULL的列，对于`MySQL`来说更难优化，因为可为NULL的列使得索引、索引统计和值比较都更复杂，可为NULL的列会使用更多的存储空间，在`MySQL`里也需要特殊处理。当可为NULL的列被索引时，每个索引记录需要一个额外的字节，在`MyISAM`里甚至还看你导致固定大小的索引（例如只有一个整数列的索引）变成可变大小的索引。
>
> 通常把可为NULL的列改为NOT NULL带来的性能提升比较小，所以（调优时）没有必要首先在现有的schema中查找并修改掉这种情况，除非确定这会导致问题。但是，如果计划在列上建索引，就应该尽量避免设计成可为NULL的列。
>
> 当然也有例外，例如值得一提的是，`InnoDB`使用单独位（bit）存储NULL值，所以对于稀疏数据有很好的空间效率。但是这一点不适用于`MyISAM`。

最后一句话，完全没有看懂。

把书中所说的点总结一下，这里仅针对`InnoDB`作为参数：

1. 如果不设置NOT NULL的话，NULL是列的默认值，如果不是本身需要的话，尽量不要适用NULL
2. 使用NULL会带来更多的问题，比如索引、索引统计、估值计算更加复杂，如果使用索引，就要避免列设置成NULL
3. 如果是索引列，会带来存储空间的问题，需要额外的特殊处理，还会导致更多的存储空间占用
4. 对于稀疏数据有更好的空间效率。稀疏数组指的是很多值为NULL，只有少数行的列为非NULL值的数组

### 设置为NULL的影响

#### 默认值

对于MySQL而言，如果列不是NOT NULL，且没有主动设置值的话，那么插入数据的默认值为NULL

NULL和NOT NULL使用的空值代表的含义不同：

**NULL可以认为这一列的值是未知的，空值则可以认为我们知道这个值，只不过他是空的。**

举个例子，一张表中的某一条`name`字段是NULL，我们可以认为**不知道名字是什么**，反之如果是空字符串则可以认为**我们知道没有名字，他就是一个空值**。

对于程序的大多数情况来说，没有什么特殊需要非要把字段设置为NULL，NULL值反而会对程序造成很多问题：如空指针

#### 值计算

##### 1.对于NULL值的列，使用聚合函数的时候会忽略NULL值。

**`count(*)`是对表中的行数进行统计，`count(name)`则是对表中非NULL的列进行统计。**

##### 2.**=失效**

对于NULL值的列，是不能使用`=`表达式进行判断的，下面对`name`的查询是不成立的，必须使用`is NULL`。

##### 3.**与其他值运算**

NULL和其他任何值进行运算都是NULL，包括表达式的值也是NULL。

`user`表第二条记录`age`是NULL，所以`+1`之后还是NULL，`name`是NULL，进行`concat`运算之后结果还是NULL。

![hi](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3df3d581bef4407e883fd2c0ba31a042~tplv-k3u1fbpfcp-zoom-1.image)

可以再看下下面的例子，任何和NULL进行运算的话得出的结果都会是NULL，想象下你设计的某个字段如果是NULL还不小心进行各种运算，最后得出的结果。。。

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b398422767884b78bd6234cd1483bd15~tplv-k3u1fbpfcp-zoom-1.image)

##### 4.distinct、group by、order by

对于`distinct`和`group by`来说，所有的NULL值都会被视为相等，对于`order by`来说升序NULL会排在最前

##### 5.查询 !=  xx

如果需要查询 `!=` 的数据，只会查询出 <u>不为null && 值不等于 xx</u> 的数据，如果要查询出不为null的数据：is not null

